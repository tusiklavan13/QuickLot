<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>QuickLot – Futures Size Calculator</title>
<style>
:root{
  --bg:#0f1226; --card:#15193a; --card2:#101433; --text:#e9ecff; --muted:#b5b9d9;
  --primary:#6c8dff; --accent:#7ef0d4; --warn:#ffb3b3; --border:#27306a; --btn:#5a77ff;
}
*{box-sizing:border-box}
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;margin:0;background:linear-gradient(180deg,#0b0e22,#0f1226 40%,#0b0e22);color:var(--text)}
.container{max-width:860px;margin:24px auto;padding:0 16px}
h1{font-size:1.5rem;margin:0 0 16px;display:flex;gap:10px;align-items:center}
.badge{font-size:.75rem;padding:4px 8px;border-radius:999px;background:rgba(126,240,212,.15);color:var(--accent);border:1px solid rgba(126,240,212,.3)}
.card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:16px;margin:14px 0;box-shadow:0 6px 18px rgba(0,0,0,.25)}
label{display:block;font-weight:600;margin:.5rem 0 .35rem;color:var(--muted)}
input,select,button{font:inherit;width:100%;padding:.7rem;border:1px solid var(--border);border-radius:12px;background:var(--card2);color:var(--text)}
select,input{background-image:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,0))}
button{cursor:pointer;font-weight:700;background:var(--btn);border:none}
button:hover{filter:brightness(1.05)}
.row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
@media (max-width:720px){.row{grid-template-columns:1fr}}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.value{font-weight:700}
.subtle{color:var(--muted);font-size:.9rem}
.warn{background:rgba(255,179,179,.1);border:1px solid rgba(255,179,179,.4);color:#ffd0d0;padding:10px;border-radius:10px;margin-top:10px}
.hr{height:1px;background:var(--border);margin:12px 0}
.notice{font-size:.85rem;color:var(--muted)}
.pill{display:inline-block;padding:4px 10px;border-radius:999px;border:1px solid var(--border);background:var(--card2);font-size:.8rem}

/* favorites UI */
#symbolRow{display:flex; gap:8px; align-items:center}
#symbolInput{flex:1}
#favBtn{width:38px; height:38px; border-radius:8px; font-size:18px; line-height:1; background:var(--card2); border:1px solid var(--border)}
#favBtn:hover{filter:brightness(1.06)}
#favChips{margin-top:8px; display:flex; flex-wrap:wrap; gap:8px}
.chip{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;border:1px solid var(--border);background:var(--card2);cursor:pointer}
.chip:hover{filter:brightness(1.06)}
.small{font-size:.85rem}
</style>
</head>
<body>
<nav>
  <div class="navwrap">
    <a class="brand" href="index.html">QuickLot</a>
    <a href="market-table.html">Market Table</a>
    <a href="premium.html">Premium</a>
    <a href="terms.html">Terms</a>
    <a href="about.html">About</a>
  </div>
</nav>
<div class="container">

  <div class="container">
  <h1>QuickLot <span class="badge">Futures Size Calculator</span></h1>
  <div class="subtle">Enter risk & stop (ticks) → get contracts. Shows results <b>before</b> and <b>after</b> commission.</div>

  <div class="card">
    <div class="row">
      <div>
        <label for="symbolInput">Symbol (type to search)</label>
        <div id="symbolRow">
          <input id="symbolInput" list="symbolList" placeholder="e.g., MNQ, MES, MGC">
          <button id="favBtn" type="button" title="Toggle favorite" aria-label="Toggle favorite">☆</button>
        </div>
        <datalist id="symbolList"></datalist>
        <div class="small subtle" id="symbolName"></div>
        <div id="favChips"></div>
      </div>

      <div>
        <label for="broker">Broker / Prop</label>
        <select id="broker">
          <option value="TopstepX">TopstepX</option>
          <option value="Tradovate">Tradovate</option>
          <option value="Rithmic">Rithmic</option>
          <option value="Plus500">Plus500 (T4)</option>
          <option value="Custom">Custom…</option>
        </select>
        <div class="small subtle">Changing symbol/broker auto-fills fee. You can override it.</div>
      </div>
    </div>

    <div class="row">
      <div>
        <label for="risk">Risk per trade ($)</label>
        <input id="risk" type="number" inputmode="decimal" placeholder="e.g. 300">
      </div>
      <div>
        <label for="stopTicks">Stop loss (ticks)</label>
        <input id="stopTicks" type="number" inputmode="numeric" placeholder="e.g. 30">
      </div>
    </div>

    <div class="row">
      <div>
        <label for="fee">Fee per contract ($) – round-turn</label>
        <input id="fee" type="number" inputmode="decimal" step="0.01" placeholder="Auto-filled">
      </div>
      <div id="customTickBox" style="display:none">
        <label for="customTickValue">Custom Tick Value ($)</label>
        <input id="customTickValue" type="number" inputmode="decimal" step="0.01" placeholder="e.g. 0.50">
      </div>
    </div>

    <button id="calcBtn">Calculate</button>
    <div id="msg" class="warn" style="display:none"></div>
  </div>

  <div class="card">
    <div class="grid">
      <div class="pill">Tick value</div><div class="value" id="tickValue">$0.50 / tick</div>
      <div>Risk <b>per contract (before fees)</b>:</div><div class="value" id="rpcBefore">$0.00</div>
      <div>Risk <b>per contract (after fees)</b>:</div><div class="value" id="rpcAfter">$0.00</div>
    </div>
    <div class="hr"></div>
    <div class="grid">
      <div>Contracts (rounded down):</div><div class="value" id="contracts">0</div>
      <div>Total risk <b>before fees</b>:</div><div class="value" id="totalBefore">$0.00</div>
      <div>Total risk <b>after fees</b>:</div><div class="value" id="totalAfter">$0.00</div>
    </div>
    <div class="hr"></div>
    <div class="grid">
      <div>1R (after fees):</div><div class="value" id="r1">$0.00</div>
      <div>2R (after fees):</div><div class="value" id="r2">$0.00</div>
      <div>3R (after fees):</div><div class="value" id="r3">$0.00</div>
      <div>4R (after fees):</div><div class="value" id="r4">$0.00</div>
      <div>5R (after fees):</div><div class="value" id="r5">$0.00</div>
    </div>
    <p class="notice">Sizing uses the <b>after-fees</b> risk per contract. Both views are shown for clarity.</p>
  </div>

  <div class="subtle small">For calculation purposes only. No financial advice. Fees may change—verify with your provider.</div>
</div>

<script>
(function(){
  // ===== Symbol specs: USD tick values (subset; extend as needed) =====
  const SYMBOLS = {
    // CME Equity
    ES:{name:"E-mini S&P 500", tv:12.50}, MES:{name:"Micro E-mini S&P 500", tv:1.25},
    NQ:{name:"E-mini Nasdaq-100", tv:5.00}, MNQ:{name:"Micro E-mini Nasdaq-100", tv:0.50},
    RTY:{name:"E-mini Russell 2000", tv:5.00}, M2K:{name:"Micro E-mini Russell 2000", tv:0.50},
    YM:{name:"Mini Dow", tv:5.00}, MYM:{name:"Micro Mini Dow", tv:0.50},
    NKD:{name:"Nikkei 225 (USD)", tv:5.00}, MBT:{name:"Micro E-mini Bitcoin", tv:0.50}, MET:{name:"Micro E-mini Ether", tv:0.50},
    // Energy/Metals
    CL:{name:"Crude Oil", tv:10.00}, MCL:{name:"Micro Crude Oil", tv:1.00}, QM:{name:"E-mini Crude Oil", tv:12.50},
    NG:{name:"Nat Gas", tv:10.00}, QG:{name:"E-mini Nat Gas", tv:12.50}, MNG:{name:"Micro Nat Gas", tv:1.00},
    RB:{name:"RBOB Gasoline", tv:4.20}, HO:{name:"Heating Oil", tv:4.20}, PL:{name:"Platinum", tv:5.00},
    // COMEX
    GC:{name:"Gold", tv:10.00}, MGC:{name:"Micro Gold", tv:1.00},
    SI:{name:"Silver", tv:5.00}, SIL:{name:"Micro Silver", tv:1.00}, HG:{name:"Copper", tv:12.50}, MHG:{name:"Micro Copper", tv:1.25},
    // CBOT Rates
    ZT:{name:"2-Year Note", tv:15.625}, ZF:{name:"5-Year Note", tv:7.8125}, ZN:{name:"10-Year Note", tv:15.625},
    ZB:{name:"30-Year Bond", tv:31.25}, UB:{name:"Ultra T-Bond", tv:31.25}, TN:{name:"Ultra 10-Year Note", tv:31.25},
    // CBOT Ags
    ZC:{name:"Corn", tv:12.50}, ZW:{name:"Wheat", tv:12.50}, ZS:{name:"Soybeans", tv:12.50},
    ZM:{name:"Soybean Meal", tv:10.00}, ZL:{name:"Soybean Oil", tv:6.00},
    // CME FX
    "6A":{name:"AUD", tv:6.25}, M6A:{name:"Micro AUD/USD", tv:1.00},
    "6B":{name:"GBP", tv:6.25}, M6B:{name:"Micro GBP/USD", tv:1.00},
    "6C":{name:"CAD", tv:10.00}, "6E":{name:"EUR", tv:12.50}, M6E:{name:"Micro EUR/USD", tv:1.25},
    "6J":{name:"JPY", tv:12.50}, "6S":{name:"CHF", tv:12.50}, "6M":{name:"MXN", tv:5.00}, "6N":{name:"NZD", tv:10.00},
    // Livestock
    LE:{name:"Live Cattle", tv:10.00}, HE:{name:"Lean Hogs", tv:10.00}
  };

  // ===== Round-turn fees per Broker/Prop (edit if your provider changes) =====
  const FEES = {
    TopstepX:{
      ES:2.80, MES:0.74, NQ:2.80, MNQ:0.74, RTY:2.80, M2K:0.74, NKD:4.34, MBT:2.34, MET:0.24,
      CL:3.04, MCL:1.04, QM:2.44, PL:3.24, QG:1.04, RB:3.04, HO:3.04, NG:3.20, MNG:1.24,
      YM:2.80, MYM:0.74,
      "6A":3.24, M6A:0.52, "6B":3.24, "6C":3.24, "6E":3.24, M6E:0.52, "6J":3.24, "6S":3.24,
      E7:1.74, "6M":3.24, "6N":3.24, M6B:0.52,
      ZT:1.34, ZF:1.34, ZN:1.60, ZB:1.78, UB:1.94, TN:1.64,
      GC:3.24, MGC:1.24, SI:3.24, SIL:2.04, HG:3.24, MHG:1.24,
      HE:4.24, LE:4.24, ZC:4.30, ZW:4.30, ZS:4.30, ZM:4.30, ZL:4.30
    },
    Tradovate:{
      ES:4.28, MES:1.34, NKD:5.82, NQ:4.28, MNQ:1.34, RTY:4.28, M2K:1.34, MBT:5.64, MET:0.84,
      "6A":4.72, M6A:2.20, "6B":4.72, "6C":4.72, "6E":4.72, M6E:1.12, "6J":4.72, "6S":4.72,
      E7:3.22, "6M":4.72, "6N":4.72, M6B:1.12,
      LE:5.72, HE:5.72,
      CL:4.52, MCL:1.64, QM:3.92, NG:4.72, PL:4.72, QG:2.52, RB:4.52, HO:4.52, MNG:2.32,
      ZC:5.72, ZW:5.72, ZS:5.72, ZM:5.72, ZL:5.72,
      YM:4.28, MYM:1.34,
      GC:4.72, MGC:1.64, SI:4.72, SIL:2.64, HG:4.72, MHG:1.08
    },
    Rithmic:{
      ES:4.36, MES:1.42, NKD:5.90, NQ:4.36, MNQ:1.42, RTY:4.36, M2K:1.42, MBT:5.72, MET:0.92,
      "6A":4.80, M6A:1.20, "6B":4.80, "6C":4.80, "6E":4.80, M6E:1.20, "6J":4.80, "6S":4.80,
      E7:3.30, "6M":4.80, "6N":4.80, M6B:1.20,
      LE:5.80, HE:5.80,
      CL:4.60, MCL:1.72, QM:4.00, NG:4.80, PL:4.80, QG:2.60, RB:4.60, HO:4.60, MNG:1.92,
      ZC:5.80, ZW:5.80, ZS:5.80, ZM:5.80, ZL:5.80,
      YM:4.36, MYM:1.42,
      GC:4.80, MGC:1.72, SI:4.80, SIL:2.72, HG:4.80, MHG:1.92
    },
    Plus500:{
      ES:4.80, MES:null, NKD:6.34, NQ:4.80, MNQ:null, RTY:4.80, M2K:null, MBT:null, MET:null,
      "6A":5.24, M6A:null, "6B":5.24, "6C":5.24, "6E":5.24, M6E:null, "6J":5.24, "6S":5.24, E7:3.74,
      "6M":5.24, "6N":5.24,
      LE:6.24, HE:6.24,
      CL:5.04, MCL:null, QM:4.44, NG:5.24, QG:3.04, PL:5.24, RB:5.04,
      ZC:6.30, ZW:6.30, ZS:6.30, ZM:6.30, ZL:6.30,
      YM:4.80, MYM:null,
      GC:5.24, MGC:null, SI:5.24, SIL:null, HG:5.24
    }
  };

  // ===== helpers =====
  const $ = id => document.getElementById(id);
  const fmt$ = v => isFinite(v)?('$'+v.toFixed(2)):'$0.00';

  // build datalist from SYMBOLS
  const list = $('symbolList');
  for(const [code, info] of Object.entries(SYMBOLS)){
    const opt = document.createElement('option');
    opt.value = code;
    opt.label = `${code} — ${info.name}`;
    list.appendChild(opt);
  }

  // ---- last state (autosave) ----
  function saveState(){
    const state = {
      symbolInput: ($('symbolInput')?.value||'').trim().toUpperCase(),
      broker: $('broker')?.value || 'TopstepX',
      risk: $('risk')?.value || '',
      stopTicks: $('stopTicks')?.value || '',
      fee: $('fee')?.value || '',
      customTickValue: $('customTickValue')?.value || ''
    };
    try { localStorage.setItem('quicklot:lastState', JSON.stringify(state)); } catch(e){}
  }
  function loadState(){
    try {
      const raw = localStorage.getItem('quicklot:lastState');
      if(!raw) return;
      const s = JSON.parse(raw);
      if(s.symbolInput) $('symbolInput').value = s.symbolInput;
      if(s.broker) $('broker').value = s.broker;
      if(s.risk) $('risk').value = s.risk;
      if(s.stopTicks) $('stopTicks').value = s.stopTicks;
      if(s.fee || s.fee === 0) $('fee').value = s.fee;
      if(s.customTickValue) $('customTickValue').value = s.customTickValue;
    } catch(e){}
  }
  function wireAutosave(){
    ['symbolInput','broker','risk','stopTicks','fee','customTickValue']
      .forEach(id => { const el=$(id); if(el){ el.addEventListener('input', saveState); }});
  }

  // ---- favorites (star) ----
  function loadFavs(){
    try{ const raw = localStorage.getItem('quicklot:favs'); if(raw) return JSON.parse(raw);}catch(e){}
    return ['MNQ','MYM','MGC']; // defaults
  }
  function saveFavs(favs){ try{ localStorage.setItem('quicklot:favs', JSON.stringify(favs)); }catch(e){} }
  function isFav(sym){ return loadFavs().includes(sym); }
  function toggleFav(sym){
    if(!sym) return;
    let favs = loadFavs();
    favs = favs.includes(sym) ? favs.filter(s=>s!==sym) : [...favs, sym];
    saveFavs(favs); renderFavs(); paintStar();
  }
  function renderFavs(){
    const wrap = $('favChips'); wrap.innerHTML='';
    loadFavs().forEach(code=>{
      const chip = document.createElement('button');
      chip.type='button'; chip.className='chip'; chip.title = SYMBOLS[code]?.name || code;
      chip.textContent = `★ ${code}`;
      chip.addEventListener('click', ()=>{
        $('symbolInput').value = code; updateSymbolMeta(); saveState();
      });
      wrap.appendChild(chip);
    });
  }
  function paintStar(){ $('favBtn').textContent = isFav(getSymbol()) ? '★' : '☆'; }

  $('favBtn').addEventListener('click', ()=> toggleFav(getSymbol()));

  // ---- UI events ----
  $('symbolInput').addEventListener('input', ()=>{ updateSymbolMeta(); saveState(); });
  $('broker').addEventListener('change', ()=>{ autoFillFee(); saveState(); });
  $('calcBtn').addEventListener('click', ()=>{ calculate(); saveState(); });

  // ---- init ----
  loadState();
  if(!$('symbolInput').value){ $('symbolInput').value = 'MNQ'; }
  updateSymbolMeta();
  renderFavs();
  paintStar();
  wireAutosave();

  // ---- logic ----
  function getSymbol(){ return ($('symbolInput').value || '').trim().toUpperCase(); }

  function updateSymbolMeta(){
    const code = getSymbol();
    const info = SYMBOLS[code];
    $('symbolName').textContent = info ? info.name : '';
    $('tickValue').textContent = info ? fmt$(info.tv)+' / tick' : '—';
    $('customTickBox').style.display = info ? 'none' : 'block';
    autoFillFee();
    paintStar();
  }

  function autoFillFee(){
    const sym = getSymbol();
    const broker = $('broker').value;
    if(broker==='Custom') return;
    const sch = FEES[broker]; if(!sch) return;
    const fee = Object.prototype.hasOwnProperty.call(sch, sym) ? sch[sym] : null;
    if(fee==null || isNaN(fee)){
      $('fee').value = ''; $('fee').placeholder = 'Unavailable for this broker/symbol';
    }else{
      $('fee').value = fee.toString();
    }
  }

  function currentTickValue(){
    const sym = getSymbol();
    if(SYMBOLS[sym]) return SYMBOLS[sym].tv;
    const v = parseFloat($('customTickValue').value);
    return (v>0)? v : NaN;
  }

  function calculate(){
    $('msg').style.display='none';
    const tickVal = currentTickValue();
    const risk = parseFloat($('risk').value);
    const stopT = parseFloat($('stopTicks').value);
    const fee = parseFloat($('fee').value);

    if(!(risk>0) || !(stopT>0) || !(fee>=0) || !(tickVal>0)){
      show('Please enter: risk > 0, stop ticks > 0, fee ≥ 0, and a valid tick value.');
      return;
    }
    const rpcBefore = stopT * tickVal;
    const rpcAfter  = stopT * tickVal + fee;
    const contracts = Math.floor(risk / rpcAfter);
    const totalBefore = contracts * rpcBefore;
    const totalAfter  = contracts * rpcAfter;

    $('rpcBefore').textContent = fmt$(rpcBefore);
    $('rpcAfter').textContent  = fmt$(rpcAfter);
    $('contracts').textContent = contracts;
    $('totalBefore').textContent = fmt$(totalBefore);
    $('totalAfter').textContent  = fmt$(totalAfter);

    for(let n=1;n<=5;n++) $('r'+n).textContent = fmt$(totalAfter*n);

    if(contracts<1) show('Increase risk or decrease stop to get at least 1 contract (after-fees sizing).');
  }

  function show(txt){ $('msg').textContent = txt; $('msg').style.display='block'; }
})();
</script>
  <footer>© <span id="y"></span> QuickLot — For calculation purposes only. No financial advice.</footer>
<script>document.getElementById('y').textContent=new Date().getFullYear()</script>

</body>
</html>
